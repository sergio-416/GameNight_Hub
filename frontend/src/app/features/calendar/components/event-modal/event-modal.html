@if (isOpen()) {
<div
	data-testid="modal-backdrop"
	class="fixed top-0 left-0 z-20 flex h-screen w-screen items-center justify-center bg-slate-900/50 backdrop-blur-sm"
	role="dialog"
	aria-modal="true"
	tabindex="-1"
	(click)="handleBackdropClick($event)"
>
	<div
		data-testid="event-modal"
		class="flex max-h-[90vh] w-11/12 max-w-lg flex-col gap-6 overflow-hidden rounded-lg bg-white p-6 text-slate-600 shadow-xl shadow-slate-700/20"
		role="document"
		(click)="$event.stopPropagation()"
	>
		<header class="flex items-center gap-4 border-b border-slate-100 pb-4">
			<h3 class="flex-1 text-xl font-semibold text-slate-800">Edit Event</h3>
			<button
				data-testid="close-button"
				type="button"
				class="inline-flex h-10 w-10 items-center justify-center gap-2 rounded-full text-slate-400 transition duration-300 hover:bg-slate-100 hover:text-slate-600 focus:bg-slate-200 focus:text-slate-700"
				(click)="closeModal()"
				aria-label="close dialog"
			>
				<svg
					xmlns="http://www.w3.org/2000/svg"
					class="h-5 w-5"
					fill="none"
					viewBox="0 0 24 24"
					stroke="currentColor"
					stroke-width="2"
				>
					<path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
				</svg>
			</button>
		</header>

		<div class="flex-1 space-y-4 overflow-auto">
			<div class="relative">
				<label for="event-title" class="mb-1 block text-sm font-medium text-slate-700">
					Event Title <span class="text-pink-500">*</span>
				</label>
				<input
					id="event-title"
					data-testid="title-input"
					type="text"
					[value]="formData().title"
					(input)="updateField('title', $any($event.target).value)"
					class="relative h-10 w-full rounded-lg border border-slate-200 px-4 text-sm text-slate-700 outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20"
					placeholder="Enter event title"
				/>
			</div>

			<div class="relative">
				<label for="event-description" class="mb-1 block text-sm font-medium text-slate-700">
					Description
				</label>
				<textarea
					id="event-description"
					data-testid="description-input"
					[value]="formData().description || ''"
					(input)="updateField('description', $any($event.target).value)"
					rows="3"
					class="relative w-full resize-none rounded-lg border border-slate-200 px-4 py-2 text-sm text-slate-700 outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20"
					placeholder="Add event description..."
				></textarea>
			</div>

			<div class="relative">
				<label for="max-players" class="mb-1 block text-sm font-medium text-slate-700">
					Max Players
				</label>
				<input
					id="max-players"
					data-testid="max-players-input"
					type="number"
					[value]="formData().maxPlayers || ''"
					(input)="updateField('maxPlayers', +$any($event.target).value)"
					class="relative h-10 w-full rounded-lg border border-slate-200 px-4 text-sm text-slate-700 outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20"
					placeholder="Number of players"
					min="1"
				/>
			</div>
		</div>

		<footer class="flex justify-between gap-3 border-t border-slate-100 pt-4">
			<button
				data-testid="delete-button"
				type="button"
				class="inline-flex h-10 items-center justify-center rounded-lg px-4 text-sm font-medium tracking-wide text-pink-600 transition duration-300 hover:bg-pink-50 focus:bg-pink-100 disabled:cursor-not-allowed disabled:opacity-50"
				(click)="handleDelete()"
				[disabled]="deleting()"
			>
				@if (deleting()) {
				<span>Deleting...</span>
				} @else {
				<span>Delete</span>
				}
			</button>

			<div class="flex gap-3">
				<button
					type="button"
					class="inline-flex h-10 items-center justify-center rounded-lg px-5 text-sm font-medium tracking-wide text-slate-600 transition duration-300 hover:bg-slate-100 focus:bg-slate-200"
					(click)="closeModal()"
				>
					Cancel
				</button>
				<button
					data-testid="save-button"
					type="button"
					class="inline-flex h-10 items-center justify-center rounded-lg bg-emerald-500 px-5 text-sm font-medium tracking-wide text-white transition duration-300 hover:bg-emerald-600 focus:bg-emerald-700 disabled:cursor-not-allowed disabled:bg-emerald-300"
					(click)="handleSave()"
					[disabled]="!isValid() || saving()"
				>
					@if (saving()) {
					<span>Saving...</span>
					} @else {
					<span>Save Changes</span>
					}
				</button>
			</div>
		</footer>
	</div>
</div>
}
